<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üìä –î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–∫–∞–∑–æ–≤ + –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  /* –û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ */
  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --primary-light: #818cf8;
  --success: #10b981;
  --success-light: #34d399;
  --warning: #f59e0b;
  --warning-light: #fbbf24;
  --danger: #ef4444;
  --danger-light: #f87171;
  --info: #06b6d4;
  --info-light: #22d3ee;
  
  /* –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
  --bg-primary: #f8fafc;
  --bg-secondary: #ffffff;
  --bg-tertiary: #f1f5f9;
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --text-tertiary: #94a3b8;
  --border: #e2e8f0;
  
  /* –≠—Ñ—Ñ–µ–∫—Ç—ã */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.15);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --radius: 16px;
  --radius-lg: 24px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, var(--bg-primary) 0%, #eef2ff 100%);
  color: var(--text-primary);
  line-height: 1.6;
  min-height: 100vh;
  padding-bottom: 40px;
}

.container {
  max-width: 1600px;
  margin: 0 auto;
  padding: 24px;
}

/* === Header === */
.dashboard-header {
  text-align: center;
  margin-bottom: 32px;
  padding: 32px 24px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg), var(--shadow-glow);
  position: relative;
  overflow: hidden;
  color: white;
}

.dashboard-header::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
  animation: pulse 4s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50% { transform: scale(1.1); opacity: 0.8; }
}

.dashboard-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  position: relative;
  z-index: 1;
}

.dashboard-header h1 i {
  font-size: 1.8rem;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

.dashboard-header p {
  color: rgba(255, 255, 255, 0.9);
  max-width: 700px;
  margin: 0 auto;
  font-size: 1.05rem;
  position: relative;
  z-index: 1;
}

/* === Upload Area === */
.upload-area {
  border: 3px dashed var(--border);
  border-radius: var(--radius-lg);
  padding: 48px 32px;
  text-align: center;
  background: var(--bg-secondary);
  cursor: pointer;
  transition: var(--transition);
  margin-bottom: 32px;
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}

.upload-area::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--primary), var(--info), var(--success));
  opacity: 0;
  transition: var(--transition);
}

.upload-area:hover, 
.upload-area.dragover {
  border-color: var(--primary);
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.03), rgba(6, 182, 212, 0.03));
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.upload-area:hover::before,
.upload-area.dragover::before {
  opacity: 1;
}

.upload-area i {
  font-size: 56px;
  color: var(--primary);
  margin-bottom: 16px;
  display: block;
  transition: var(--transition);
}

.upload-area:hover i {
  transform: scale(1.1);
  color: var(--primary-dark);
}

.upload-area h2 {
  font-size: 1.4rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
  transition: var(--transition);
}

.upload-area.dragover h2 {
  color: var(--primary);
}

.upload-area p {
  color: var(--text-secondary);
  font-size: 1rem;
}

.upload-area input[type="file"] {
  display: none;
}

/* === Summary Cards === */
.summary-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-bottom: 32px;
}

.card {
  background: var(--bg-secondary);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 16px;
  border: 1px solid var(--border);
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, transparent, currentColor, transparent);
  opacity: 0;
  transition: var(--transition);
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  border-color: var(--primary-light);
}

.card:hover::before {
  opacity: 1;
}

.card-icon {
  width: 64px;
  height: 64px;
  border-radius: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  font-size: 26px;
  transition: var(--transition);
}

.card:hover .card-icon {
  transform: scale(1.05);
}

.total-revenue .card-icon { background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(99, 102, 241, 0.05)); color: var(--primary); }
.total-orders .card-icon { background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.05)); color: var(--success); }
.avg-check .card-icon { background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(6, 182, 212, 0.05)); color: var(--info); }
.last-update .card-icon { background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(245, 158, 11, 0.05)); color: var(--warning); }

.card-content {
  flex: 1;
  min-width: 0;
}

.card-content h3 {
  font-size: 0.9rem;
  font-weight: 500;
  color: var(--text-secondary);
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.value {
  font-size: 1.75rem;
  font-weight: 700;
  margin: 4px 0;
  color: var(--text-primary);
  line-height: 1.2;
}

.subtitle {
  font-size: 0.85rem;
  color: var(--text-tertiary);
}

/* === Charts Container === */
.charts-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(520px, 1fr));
  gap: 24px;
  margin-bottom: 32px;
}

.chart-box {
  background: var(--bg-secondary);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  display: flex;
  flex-direction: column;
  min-height: 400px;
  border: 1px solid var(--border);
  transition: var(--transition);
}

.chart-box:hover {
  box-shadow: var(--shadow-lg);
  border-color: var(--primary-light);
}

.chart-box h2 {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.chart-box h2 i {
  color: var(--primary);
  font-size: 1.1rem;
}

.chart-container {
  flex: 1;
  position: relative;
  min-height: 300px;
}

/* === Revenue Trend Chart === */
.trend-controls {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
  flex-wrap: wrap;
  align-items: center;
}

.trend-controls select {
  padding: 8px 16px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 0.9rem;
  cursor: pointer;
  transition: var(--transition);
}

.trend-controls select:hover,
.trend-controls select:focus {
  border-color: var(--primary);
  outline: none;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.trend-legend {
  display: flex;
  gap: 20px;
  margin-top: 12px;
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.trend-legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}

.trend-legend-color {
  width: 12px;
  height: 12px;
  border-radius: 3px;
}

.trend-legend-color.up { background: var(--success); }
.trend-legend-color.down { background: var(--danger); }

/* === Progress Bars === */
.progress-group {
  margin-bottom: 24px;
  padding: 16px;
  background: var(--bg-tertiary);
  border-radius: 12px;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
  font-size: 0.95rem;
}

.progress-title {
  font-weight: 500;
  color: var(--text-primary);
}

.progress-value {
  color: var(--text-secondary);
  font-weight: 500;
}

.progress {
  height: 12px;
  background: var(--border);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}

.progress-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  100% { left: 100%; }
}

/* === History Section === */
.history-section {
  background: var(--bg-secondary);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  margin-bottom: 32px;
  border: 1px solid var(--border);
}

.history-section h2 {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.history-controls {
  margin-bottom: 16px;
}

.reset-button {
  background: linear-gradient(135deg, var(--danger), #dc2626);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 10px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 500;
  transition: var(--transition);
  box-shadow: var(--shadow);
}

.reset-button:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
  background: linear-gradient(135deg, #dc2626, #b91c1c);
}

.history-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.history-item {
  display: flex;
  align-items: center;
  padding: 16px;
  border-radius: 12px;
  background: var(--bg-tertiary);
  transition: var(--transition);
  border: 1px solid transparent;
}

.history-item:hover {
  background: var(--bg-secondary);
  border-color: var(--primary-light);
  transform: translateX(4px);
}

.history-item-icon {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(99, 102, 241, 0.05));
  color: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 16px;
  flex-shrink: 0;
  font-size: 18px;
}

.history-item-details {
  flex: 1;
  min-width: 0;
}

.history-item-details h4 {
  margin-bottom: 4px;
  font-size: 1rem;
  font-weight: 500;
  color: var(--text-primary);
}

.history-item-details p {
  color: var(--text-secondary);
  font-size: 0.85rem;
}

.history-item-actions {
  display: flex;
  gap: 8px;
}

.btn-remove {
  background: none;
  border: none;
  color: var(--danger);
  cursor: pointer;
  width: 36px;
  height: 36px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  font-size: 14px;
}

.btn-remove:hover {
  background: rgba(239, 68, 68, 0.1);
  transform: scale(1.1);
}

/* === Data Table === */
.data-table {
  background: var(--bg-secondary);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 24px;
  margin-bottom: 32px;
  border: 1px solid var(--border);
}

.data-table h2 {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.table-controls {
  display: flex;
  justify-content: space-between;
  margin-bottom: 20px;
  flex-wrap: wrap;
  gap: 16px;
  align-items: center;
}

.search-box {
  position: relative;
  flex: 1;
  max-width: 320px;
}

.search-box i {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-tertiary);
  font-size: 14px;
}

.search-box input {
  width: 100%;
  padding: 12px 14px 12px 40px;
  border: 2px solid var(--border);
  border-radius: 12px;
  font-size: 0.95rem;
  background: var(--bg-tertiary);
  color: var(--text-primary);
  transition: var(--transition);
}

.search-box input:focus {
  outline: none;
  border-color: var(--primary);
  background: var(--bg-secondary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.filters {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.filters select {
  padding: 10px 16px;
  border: 2px solid var(--border);
  border-radius: 12px;
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 0.9rem;
  cursor: pointer;
  transition: var(--transition);
  min-width: 140px;
}

.filters select:hover,
.filters select:focus {
  border-color: var(--primary);
  outline: none;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.table-wrapper {
  overflow-x: auto;
  border-radius: 12px;
  border: 1px solid var(--border);
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
}

table thead {
  background: linear-gradient(135deg, var(--bg-tertiary), #e2e8f0);
}

table th {
  padding: 14px 16px;
  text-align: left;
  font-weight: 600;
  color: var(--text-primary);
  border-bottom: 2px solid var(--border);
  white-space: nowrap;
}

table td {
  padding: 14px 16px;
  border-bottom: 1px solid var(--border);
  color: var(--text-secondary);
}

table tbody tr {
  transition: var(--transition);
}

table tbody tr:hover {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.03), rgba(6, 182, 212, 0.03));
}

.amount-cell {
  font-weight: 600;
  color: var(--primary);
}

/* === Comments Column & Modal === */
.comment-cell {
  text-align: center;
  padding: 8px !important;
}

.comment-btn {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  border: 2px solid var(--border);
  background: var(--bg-secondary);
  color: var(--text-tertiary);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  position: relative;
  font-size: 14px;
}

.comment-btn:hover {
  border-color: var(--primary);
  color: var(--primary);
  background: rgba(99, 102, 241, 0.05);
  transform: scale(1.05);
}

.comment-btn.has-comment {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(99, 102, 241, 0.05));
  border-color: var(--primary-light);
  color: var(--primary);
}

.comment-btn.has-comment::after {
  content: '';
  position: absolute;
  top: 4px;
  right: 4px;
  width: 8px;
  height: 8px;
  background: var(--success);
  border-radius: 50%;
  border: 2px solid var(--bg-secondary);
}

.comment-count {
  position: absolute;
  top: -6px;
  right: -6px;
  background: var(--danger);
  color: white;
  font-size: 10px;
  font-weight: 600;
  padding: 2px 5px;
  border-radius: 10px;
  min-width: 18px;
  text-align: center;
  line-height: 1;
}

/* Modal Overlay */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(15, 23, 42, 0.6);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition);
  padding: 20px;
}

.modal-overlay.active {
  opacity: 1;
  visibility: visible;
}

/* Modal Box */
.modal {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  width: 100%;
  max-width: 520px;
  max-height: 85vh;
  display: flex;
  flex-direction: column;
  animation: modalSlide 0.3s ease-out;
  border: 1px solid var(--border);
}

@keyframes modalSlide {
  from { opacity: 0; transform: translateY(-20px) scale(0.98); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

.modal-header {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.modal-header h3 {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 10px;
}

.modal-close {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  border: none;
  background: var(--bg-tertiary);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  font-size: 16px;
}

.modal-close:hover {
  background: var(--danger-light);
  color: white;
}

.modal-order-info {
  padding: 12px 24px;
  background: var(--bg-tertiary);
  font-size: 0.9rem;
  color: var(--text-secondary);
  border-bottom: 1px solid var(--border);
}

.modal-order-info strong {
  color: var(--text-primary);
}

.modal-body {
  padding: 20px 24px;
  overflow-y: auto;
  flex: 1;
}

.comments-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 20px;
}

.comment-item {
  background: var(--bg-tertiary);
  border-radius: 12px;
  padding: 14px 16px;
  position: relative;
  border-left: 3px solid var(--primary);
}

.comment-item.important {
  border-left-color: var(--warning);
  background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), var(--bg-tertiary));
}

.comment-item.urgent {
  border-left-color: var(--danger);
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), var(--bg-tertiary));
}

.comment-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 8px;
  gap: 10px;
}

.comment-author {
  font-weight: 500;
  color: var(--text-primary);
  font-size: 0.95rem;
  display: flex;
  align-items: center;
  gap: 6px;
}

.comment-author i {
  color: var(--primary);
  font-size: 14px;
}

.comment-time {
  font-size: 0.8rem;
  color: var(--text-tertiary);
  white-space: nowrap;
}

.comment-text {
  color: var(--text-secondary);
  font-size: 0.95rem;
  line-height: 1.5;
  white-space: pre-wrap;
  word-break: break-word;
}

.comment-actions {
  display: flex;
  gap: 8px;
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px dashed var(--border);
}

.comment-action-btn {
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 0.85rem;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: var(--transition);
}

.comment-action-btn:hover {
  background: var(--bg-secondary);
  color: var(--text-primary);
}

.comment-action-btn.delete:hover {
  color: var(--danger);
  background: rgba(239, 68, 68, 0.1);
}

.comment-priority {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 500;
  margin-left: 8px;
}

.comment-priority.important {
  background: rgba(245, 158, 11, 0.15);
  color: var(--warning);
}

.comment-priority.urgent {
  background: rgba(239, 68, 68, 0.15);
  color: var(--danger);
}

/* Comment Form */
.comment-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

.comment-form textarea {
  width: 100%;
  min-height: 80px;
  padding: 12px 14px;
  border: 2px solid var(--border);
  border-radius: 12px;
  font-family: inherit;
  font-size: 0.95rem;
  color: var(--text-primary);
  background: var(--bg-tertiary);
  resize: vertical;
  transition: var(--transition);
}

.comment-form textarea:focus {
  outline: none;
  border-color: var(--primary);
  background: var(--bg-secondary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.comment-form textarea::placeholder {
  color: var(--text-tertiary);
}

.comment-form-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px;
}

.comment-priority-select {
  display: flex;
  gap: 6px;
}

.priority-btn {
  padding: 6px 12px;
  border: 2px solid var(--border);
  border-radius: 20px;
  background: var(--bg-secondary);
  color: var(--text-secondary);
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 4px;
}

.priority-btn:hover,
.priority-btn.active {
  border-color: currentColor;
}

.priority-btn.normal { color: var(--text-secondary); }
.priority-btn.important { color: var(--warning); }
.priority-btn.urgent { color: var(--danger); }

.priority-btn.important:hover,
.priority-btn.important.active {
  background: rgba(245, 158, 11, 0.1);
}

.priority-btn.urgent:hover,
.priority-btn.urgent.active {
  background: rgba(239, 68, 68, 0.1);
}

.comment-submit {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  padding: 10px 24px;
  border-radius: 12px;
  font-weight: 500;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: var(--transition);
  box-shadow: var(--shadow);
}

.comment-submit:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.comment-submit:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.empty-comments {
  text-align: center;
  padding: 30px 20px;
  color: var(--text-tertiary);
}

.empty-comments i {
  font-size: 40px;
  margin-bottom: 12px;
  opacity: 0.5;
}

/* Toast notification */
.toast {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: var(--text-primary);
  color: white;
  padding: 12px 20px;
  border-radius: 12px;
  box-shadow: var(--shadow-lg);
  display: flex;
  align-items: center;
  gap: 10px;
  z-index: 2000;
  animation: toastSlide 0.3s ease-out;
  font-size: 0.95rem;
}

.toast.success { background: var(--success); }
.toast.error { background: var(--danger); }

@keyframes toastSlide {
  from { opacity: 0; transform: translateX(100px); }
  to { opacity: 1; transform: translateX(0); }
}

/* === Error Message === */
.error-message {
  background: linear-gradient(135deg, #fef2f2, #fff);
  border-left: 4px solid var(--danger);
  padding: 16px 20px;
  border-radius: 12px;
  margin: 20px 0;
  display: none;
  box-shadow: var(--shadow);
  animation: slideIn 0.3s ease-out;
}

.error-message.show {
  display: block;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

.error-message h3 {
  color: var(--danger);
  margin-bottom: 6px;
  font-size: 1rem;
  font-weight: 600;
}

.error-message ul {
  padding-left: 20px;
  color: var(--text-secondary);
}

.error-message li {
  margin-bottom: 4px;
  font-size: 0.9rem;
}

/* === Footer === */
footer {
  text-align: center;
  padding: 24px;
  color: var(--text-tertiary);
  font-size: 0.9rem;
  margin-top: 20px;
}

footer a {
  color: var(--primary);
  text-decoration: none;
  transition: var(--transition);
}

footer a:hover {
  color: var(--primary-dark);
}

/* === Responsive === */
@media (max-width: 1200px) {
  .charts-container {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .container {
    padding: 16px;
  }
  
  .dashboard-header {
    padding: 24px 16px;
  }
  
  .dashboard-header h1 {
    font-size: 1.5rem;
  }
  
  .upload-area {
    padding: 32px 20px;
  }
  
  .summary-cards {
    grid-template-columns: 1fr;
  }
  
  .table-controls {
    flex-direction: column;
    align-items: stretch;
  }
  
  .search-box {
    max-width: 100%;
  }
  
  .filters {
    justify-content: center;
  }
  
  .chart-box {
    min-height: 350px;
  }
}

/* === Animations === */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.summary-cards .card {
  animation: fadeInUp 0.5s ease-out forwards;
  opacity: 0;
}

.summary-cards .card:nth-child(1) { animation-delay: 0.1s; }
.summary-cards .card:nth-child(2) { animation-delay: 0.2s; }
.summary-cards .card:nth-child(3) { animation-delay: 0.3s; }
.summary-cards .card:nth-child(4) { animation-delay: 0.4s; }

.chart-box {
  animation: fadeInUp 0.6s ease-out forwards;
  opacity: 0;
}

.charts-container .chart-box:nth-child(1) { animation-delay: 0.2s; }
.charts-container .chart-box:nth-child(2) { animation-delay: 0.3s; }
.charts-container .chart-box:nth-child(3) { animation-delay: 0.4s; }
.charts-container .chart-box:nth-child(4) { animation-delay: 0.5s; }
</style>
</head>
<body>
<div class="container">
  <header class="dashboard-header">
    <h1><i class="fas fa-chart-line"></i> –î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–∫–∞–∑–æ–≤</h1>
    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å –∑–∞–∫–∞–∑–∞–º–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ.</p>
  </header>

  <div class="error-message" id="errorMessage">
    <h3><i class="fas fa-exclamation-triangle"></i> –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞</h3>
    <ul id="errorList"></ul>
  </div>

  <div class="upload-area" id="dropZone">
    <i class="fas fa-cloud-arrow-up"></i>
    <h2>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</h2>
    <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ ‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç: <strong>.txt</strong></p>
    <input type="file" id="fileInput" accept=".txt" hidden>
  </div>

  <div class="summary-cards" id="summaryCards" style="display: none;">
    <div class="card total-revenue">
      <div class="card-icon"><i class="fas fa-coins"></i></div>
      <div class="card-content">
        <h3>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</h3>
        <p class="value" id="totalRevenue">0 ‚ÇΩ</p>
        <p class="subtitle">–∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</p>
      </div>
    </div>
    <div class="card total-orders">
      <div class="card-icon"><i class="fas fa-shopping-cart"></i></div>
      <div class="card-content">
        <h3>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</h3>
        <p class="value" id="totalOrders">0</p>
        <p class="subtitle">—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π</p>
      </div>
    </div>
    <div class="card avg-check">
      <div class="card-icon"><i class="fas fa-file-invoice-dollar"></i></div>
      <div class="card-content">
        <h3>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</h3>
        <p class="value" id="avgCheck">0 ‚ÇΩ</p>
        <p class="subtitle">–Ω–∞ –æ–¥–∏–Ω –∑–∞–∫–∞–∑</p>
      </div>
    </div>
    <div class="card last-update">
      <div class="card-icon"><i class="fas fa-clock"></i></div>
      <div class="card-content">
        <h3>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</h3>
        <p class="value" id="lastUpdate">-</p>
        <p class="subtitle">–¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</p>
      </div>
    </div>
  </div>

  <div class="charts-container" id="chartsContainer" style="display: none;">
    <!-- –ù–û–í–´–ô –ì–†–ê–§–ò–ö: –î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ -->
    <div class="chart-box">
      <h2><i class="fas fa-chart-area"></i> –î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ –ø–æ –¥–∞—Ç–∞–º</h2>
      <div class="trend-controls">
        <select id="trendPeriod">
          <option value="all">–í–µ—Å—å –ø–µ—Ä–∏–æ–¥</option>
          <option value="7">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</option>
          <option value="30">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</option>
        </select>
      </div>
      <div class="chart-container">
        <canvas id="trendChart"></canvas>
      </div>
      <div class="trend-legend">
        <div class="trend-legend-item">
          <div class="trend-legend-color up"></div>
          <span>–†–æ—Å—Ç</span>
        </div>
        <div class="trend-legend-item">
          <div class="trend-legend-color down"></div>
          <span>–°–ø–∞–¥</span>
        </div>
      </div>
    </div>

    <div class="chart-box">
      <h2><i class="fas fa-chart-bar"></i> –í—ã—Ä—É—á–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ä–∞–±–æ—Ç</h2>
      <div class="chart-container">
        <canvas id="typeChart"></canvas>
      </div>
    </div>

    <div class="chart-box">
      <h2><i class="fas fa-chart-pie"></i> –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤</h2>
      <div class="chart-container">
        <canvas id="ordersChart"></canvas>
      </div>
    </div>

    <div class="chart-box">
      <h2><i class="fas fa-trophy"></i> –¢–æ–ø-5 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö –∑–∞–∫–∞–∑–æ–≤</h2>
      <div class="chart-container">
        <canvas id="topOrdersChart"></canvas>
      </div>
    </div>

    <div class="chart-box">
      <h2><i class="fas fa-tasks"></i> –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h2>
      <div id="progressBars"></div>
    </div>
  </div>

  <div class="history-section" id="historySection" style="display: none;">
    <h2><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–æ–∫</h2>
    <div class="history-controls">
      <button class="reset-button" id="resetAllButton">
        <i class="fas fa-trash-alt"></i> –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
      </button>
    </div>
    <div class="history-list" id="historyList"></div>
  </div>

  <div class="data-table" id="dataTable" style="display: none;">
    <h2><i class="fas fa-table"></i> –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
    <div class="table-controls">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é, –∫–æ–¥—É...">
      </div>
      <div class="filters">
        <select id="typeFilter">
          <option value="">–í—Å–µ —Ç–∏–ø—ã —Ä–∞–±–æ—Ç</option>
        </select>
        <select id="dateFilter">
          <option value="">–í—Å–µ –¥–∞—Ç—ã</option>
        </select>
      </div>
    </div>
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>‚Ññ</th>
            <th>–ö–æ–¥</th>
            <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
            <th>–¢–∏–ø</th>
            <th>–î–∞—Ç–∞</th>
            <th>–§–∞–π–ª</th>
            <th>–°—É–º–º–∞</th>
            <th>–ö–≤.–º</th>
            <th>–ü–æ–≥.–º</th>
            <th style="width: 50px;"><i class="fas fa-comment-alt" title="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏"></i></th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>
  </div>

  <footer>
    <p>üìä –î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–∫–∞–∑–æ–≤ &copy; 2026 | –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚Ä¢ <a href="#">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></p>
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // === DOM Elements ===
  const dropZone = document.getElementById('dropZone');
  const fileInput = document.getElementById('fileInput');
  const chartsContainer = document.getElementById('chartsContainer');
  const summaryCards = document.getElementById('summaryCards');
  const historySection = document.getElementById('historySection');
  const dataTable = document.getElementById('dataTable');
  const errorMessage = document.getElementById('errorMessage');
  const errorList = document.getElementById('errorList');
  const resetAllButton = document.getElementById('resetAllButton');
  
  // === Global Data ===
  let allFilesData = [];
  let allOrders = [];
  let trendChartInstance = null;
  
  // === Comments System ===
  let orderComments = {};

  // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–∑ localStorage
  function loadComments() {
    try {
      const saved = localStorage.getItem('orderComments');
      if (saved) {
        orderComments = JSON.parse(saved);
      }
    } catch (e) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:', e);
      orderComments = {};
    }
  }

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
  function saveComments() {
    try {
      localStorage.setItem('orderComments', JSON.stringify(orderComments));
    } catch (e) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:', e);
      showToast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π', 'error');
    }
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –¥–ª—è –∑–∞–∫–∞–∑–∞
  function generateOrderId(order) {
    return `${order.sourceFile}_${order.number}_${order.code}`.replace(/\s+/g, '_');
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–ª—è –∑–∞–∫–∞–∑–∞
  function getOrderComments(order) {
    const orderId = generateOrderId(order);
    return orderComments[orderId] || [];
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
  function addComment(order, text, priority = 'normal') {
    const orderId = generateOrderId(order);
    const comment = {
      id: Date.now().toString(36) + Math.random().toString(36).substr(2),
      text: text.trim(),
      priority,
      author: '–í—ã',
      timestamp: new Date().toISOString()
    };
    
    if (!orderComments[orderId]) {
      orderComments[orderId] = [];
    }
    orderComments[orderId].push(comment);
    
    saveComments();
    return comment;
  }

  // –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
  function deleteComment(order, commentId) {
    const orderId = generateOrderId(order);
    if (orderComments[orderId]) {
      orderComments[orderId] = orderComments[orderId].filter(c => c.id !== commentId);
      if (orderComments[orderId].length === 0) {
        delete orderComments[orderId];
      }
      saveComments();
      return true;
    }
    return false;
  }

  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
  function formatCommentTime(isoString) {
    const date = new Date(isoString);
    const now = new Date();
    const diff = now - date;
    
    if (date.toDateString() === now.toDateString()) {
      return date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
    }
    const yesterday = new Date(now);
    yesterday.setDate(yesterday.getDate() - 1);
    if (date.toDateString() === yesterday.toDateString()) {
      return '–í—á–µ—Ä–∞';
    }
    if (diff < 7 * 24 * 60 * 60 * 1000) {
      return date.toLocaleDateString('ru-RU', { weekday: 'short' });
    }
    return date.toLocaleDateString('ru-RU', { day: '2-digit', month: 'short' });
  }

  // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  function showToast(message, type = 'success') {
    const existing = document.querySelector('.toast');
    if (existing) existing.remove();
    
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.innerHTML = `
      <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
      ${message}
    `;
    document.body.appendChild(toast);
    
    setTimeout(() => {
      toast.style.opacity = '0';
      toast.style.transform = 'translateX(100px)';
      setTimeout(() => toast.remove(), 300);
    }, 3000);
  }

  // === LocalStorage Functions ===
  function saveDataToLocalStorage() {
    try {
      localStorage.setItem('dashboardData', JSON.stringify({
        allFilesData,
        allOrders,
        timestamp: Date.now()
      }));
    } catch (e) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:', e);
    }
  }
  
  function loadDataFromLocalStorage() {
    try {
      const saved = localStorage.getItem('dashboardData');
      if (saved) {
        const { allFilesData: savedFiles, allOrders: savedOrders } = JSON.parse(saved);
        if (savedFiles?.length) {
          allFilesData = savedFiles;
          allOrders = savedOrders || [];
          updateUI();
          return true;
        }
      }
    } catch (e) {
      console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', e);
    }
    return false;
  }
  
  // === UI Update ===
  function updateUI() {
    updateSummaryCards();
    renderCharts();
    renderProgressBars();
    renderDataTable();
    updateHistoryList();
    
    chartsContainer.style.display = 'grid';
    summaryCards.style.display = 'grid';
    historySection.style.display = 'block';
    dataTable.style.display = 'block';
  }
  
  // === Event Listeners ===
  dropZone.addEventListener('click', () => fileInput.click());
  
  ['dragover', 'dragenter'].forEach(evt => 
    dropZone.addEventListener(evt, e => {
      e.preventDefault();
      dropZone.classList.add('dragover');
    })
  );
  
  ['dragleave', 'drop'].forEach(evt => 
    dropZone.addEventListener(evt, e => {
      e.preventDefault();
      dropZone.classList.remove('dragover');
    })
  );
  
  dropZone.addEventListener('drop', e => {
    if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
  });
  
  fileInput.addEventListener('change', e => {
    if (e.target.files[0]) handleFile(e.target.files[0]);
  });
  
  resetAllButton.addEventListener('click', () => {
    if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?')) {
      allFilesData = [];
      allOrders = [];
      orderComments = {};
      localStorage.removeItem('dashboardData');
      localStorage.removeItem('orderComments');
      resetUI();
    }
  });
  
  // Filters
  document.getElementById('searchInput').addEventListener('input', filterTable);
  document.getElementById('typeFilter').addEventListener('change', filterTable);
  document.getElementById('dateFilter').addEventListener('change', filterTable);
  document.getElementById('trendPeriod').addEventListener('change', () => renderTrendChart());
  
  // === File Handling ===
  function handleFile(file) {
    if (!file.name.endsWith('.txt')) {
      showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ .txt');
      return;
    }
    
    const reader = new FileReader();
    reader.onload = e => {
      try {
        hideError();
        const fileData = parseOrderFile(e.target.result, file.name);
        
        if (allFilesData.some(f => f.fileName === file.name)) {
          showError('–≠—Ç–æ—Ç —Ñ–∞–π–ª —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
          return;
        }
        
        allFilesData.push(fileData);
        allOrders = allFilesData.flatMap(f => f.orders);
        
        updateUI();
        saveDataToLocalStorage();
        fileInput.value = '';
      } catch (err) {
        console.error('–û—à–∏–±–∫–∞:', err);
        showError(`–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: ${err.message}`);
      }
    };
    reader.onerror = () => showError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª');
    reader.readAsText(file, 'utf-8');
  }
  
  // === Parser ===
  function parseOrderFile(content, fileName) {
    let date = fileName.match(/(\d{2}\.\d{2}\.\d{4})/)?.[1] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
    const contentDate = content.match(/–ó–ê–ö–ê–ó–´ –ó–ê (\d{2}\.\d{2}\.\d{4})/);
    if (contentDate) date = contentDate[1];
    
    const exportMatch = content.match(/–≠–∫—Å–ø–æ—Ä—Ç: ([\d.,:\s]+)/);
    const exportDateTime = exportMatch ? exportMatch[1].trim() : new Date().toLocaleString('ru-RU');
    
    const orders = [];
    const sections = content.split('---');
    
    for (const section of sections) {
      const lines = section.trim().split('\n').filter(l => l.trim());
      if (lines.length < 2) continue;
      
      const numMatch = lines[0].match(/‚Ññ(\d+)\.\s*(.+)/);
      if (!numMatch) continue;
      
      const order = {
        number: numMatch[1],
        code: numMatch[2].trim(),
        description: '',
        type: '',
        amount: 0,
        date,
        sourceFile: fileName,
        parameters: {}
      };
      
      if (lines[1]) {
        const descMatch = lines[1].match(/([^(]+)\s*(?:\(([^)]+)\))?/);
        if (descMatch) {
          order.description = descMatch[1].trim();
          order.type = descMatch[2]?.trim() || '–ë–µ–∑ —Ç–∏–ø–∞';
        }
      }
      
      for (let i = 2; i < lines.length; i++) {
        const line = lines[i].trim();
        if (line.startsWith('–î–ª–∏–Ω–∞:')) order.parameters['–î–ª–∏–Ω–∞'] = parseFloat(line.match(/[\d.,]+/)?.[0]?.replace(',', '.'));
        if (line.startsWith('–®–∏—Ä–∏–Ω–∞:')) order.parameters['–®–∏—Ä–∏–Ω–∞'] = parseFloat(line.match(/[\d.,]+/)?.[0]?.replace(',', '.'));
        if (line.startsWith('–ö–æ–ª-–≤–æ:')) order.parameters['–ö–æ–ª-–≤–æ'] = parseInt(line.match(/\d+/)?.[0]);
        if (line.startsWith('–û–±—ä–µ–º:')) {
          const vol = line.replace('–û–±—ä–µ–º:', '').trim();
          const val = parseFloat(vol.match(/[\d.,]+/)?.[0]?.replace(',', '.'));
          if (vol.includes('–º¬≤') || vol.includes('–∫–≤.–º')) order.parameters['–ö–≤.–º'] = val;
          else if (vol.includes('–ø–æ–≥.–º')) order.parameters['–ü–æ–≥.–º'] = val;
          else if (vol.match(/—á–∞—Å|—á\b/i)) order.parameters['–í—Ä–µ–º—è'] = val;
        }
        if (line.startsWith('–°—É–º–º–∞:')) {
          const sum = line.match(/[\d.,]+/)?.[0]?.replace(',', '.');
          if (sum) order.amount = parseFloat(sum);
        }
      }
      
      if (!order.amount) {
        const lastSum = content.match(/–°—É–º–º–∞:\s*([\d.,]+)/);
        if (lastSum) order.amount = parseFloat(lastSum[1].replace(',', '.'));
      }
      
      if (order.description) orders.push(order);
    }
    
    const totalMatch = content.match(/–ò–¢–û–ì–û:\s*([\d.,]+)/);
    const total = totalMatch ? parseFloat(totalMatch[1].replace(',', '.')) : 
                  orders.reduce((s, o) => s + (o.amount || 0), 0);
    
    return { orders, total, date, exportDateTime, fileName };
  }
  
  // === Summary Cards ===
  function updateSummaryCards() {
    const revenue = allOrders.reduce((s, o) => s + o.amount, 0);
    const count = allOrders.length;
    const avg = count ? revenue / count : 0;
    
    document.getElementById('totalRevenue').textContent = formatCurrency(revenue);
    document.getElementById('totalOrders').textContent = formatNumber(count);
    document.getElementById('avgCheck').textContent = formatCurrency(avg);
    
    if (allFilesData.length) {
      const latest = allFilesData.map(f => f.exportDateTime).sort().pop();
      document.getElementById('lastUpdate').textContent = latest || '-';
    }
  }
  
  // === Charts ===
  function renderCharts() {
    renderTrendChart();
    renderTypeChart();
    renderOrdersChart();
    renderTopOrdersChart();
  }
  
  // üî• –ù–û–í–´–ô –ì–†–ê–§–ò–ö: –î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ –ø–æ –¥–∞—Ç–∞–º
  function renderTrendChart() {
    const period = document.getElementById('trendPeriod').value;
    
    const revenueByDate = {};
    allOrders.forEach(order => {
      if (!revenueByDate[order.date]) revenueByDate[order.date] = 0;
      revenueByDate[order.date] += order.amount;
    });
    
    const sortedDates = Object.keys(revenueByDate).sort((a, b) => {
      const [da, db] = [a, b].map(d => d.split('.').reverse().join('-'));
      return new Date(da) - new Date(db);
    });
    
    let filteredDates = sortedDates;
    if (period !== 'all') {
      const cutoff = new Date();
      cutoff.setDate(cutoff.getDate() - parseInt(period));
      filteredDates = sortedDates.filter(d => {
        const orderDate = new Date(d.split('.').reverse().join('-'));
        return orderDate >= cutoff;
      });
    }
    
    const labels = filteredDates;
    const values = filteredDates.map(d => revenueByDate[d]);
    
    const bgColors = values.map((v, i) => {
      if (i === 0) return 'rgba(99, 102, 241, 0.6)';
      return values[i] >= values[i-1] 
        ? 'rgba(16, 185, 129, 0.7)'
        : 'rgba(239, 68, 68, 0.7)';
    });
    
    const borderColors = bgColors.map(c => c.replace('0.7', '1').replace('0.6', '1'));
    
    const ctx = document.getElementById('trendChart').getContext('2d');
    if (trendChartInstance) trendChartInstance.destroy();
    
    trendChartInstance = new Chart(ctx, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: '–í—ã—Ä—É—á–∫–∞',
          data: values,
          borderColor: '#6366f1',
          backgroundColor: 'rgba(99, 102, 241, 0.1)',
          borderWidth: 3,
          pointBackgroundColor: bgColors,
          pointBorderColor: borderColors,
          pointRadius: 5,
          pointHoverRadius: 7,
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            backgroundColor: 'rgba(30, 41, 59, 0.95)',
            titleColor: '#fff',
            bodyColor: '#fff',
            padding: 12,
            displayColors: false,
            callbacks: {
              label: ctx => `üí∞ ${formatCurrency(ctx.parsed.y)}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: { color: 'rgba(0,0,0,0.05)' },
            ticks: {
              callback: v => formatCurrency(v),
              color: '#64748b'
            }
          },
          x: {
            grid: { display: false },
            ticks: { 
              color: '#64748b',
              maxRotation: 45,
              minRotation: 45
            }
          }
        },
        interaction: {
          intersect: false,
          mode: 'index'
        }
      }
    });
  }
  
  function renderTypeChart() {
    const data = {};
    allOrders.forEach(o => {
      data[o.type] = (data[o.type] || 0) + o.amount;
    });
    
    const labels = Object.keys(data);
    const values = Object.values(data);
    const total = values.reduce((a,b) => a+b, 0);
    
    const ctx = document.getElementById('typeChart').getContext('2d');
    if (Chart.getChart(ctx)) Chart.getChart(ctx).destroy();
    
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels,
        datasets: [{
          label: '–í—ã—Ä—É—á–∫–∞',
          data: values,
          backgroundColor: labels.map((_, i) => 
            `hsla(${(i * 60) % 360}, 70%, 60%, 0.7)`
          ),
          borderRadius: 6,
          borderSkipped: false
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: ctx => {
                const pct = ((ctx.parsed.y / total) * 100).toFixed(1);
                return `${formatCurrency(ctx.parsed.y)} (${pct}%)`;
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            ticks: { callback: v => formatCurrency(v) }
          }
        }
      }
    });
  }
  
  function renderOrdersChart() {
    const counts = {};
    allOrders.forEach(o => counts[o.type] = (counts[o.type] || 0) + 1);
    
    const ctx = document.getElementById('ordersChart').getContext('2d');
    if (Chart.getChart(ctx)) Chart.getChart(ctx).destroy();
    
    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: Object.keys(counts),
        datasets: [{
          data: Object.values(counts),
          backgroundColor: Object.keys(counts).map((_, i) => 
            `hsla(${(i * 45) % 360}, 75%, 65%, 0.9)`
          ),
          borderWidth: 3,
          borderColor: '#fff'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '65%',
        plugins: {
          legend: { position: 'right', labels: { padding: 15 } },
          tooltip: {
            callbacks: {
              label: ctx => {
                const total = ctx.dataset.data.reduce((a,b) => a+b, 0);
                const pct = ((ctx.parsed / total) * 100).toFixed(1);
                return `${ctx.label}: ${ctx.parsed} (${pct}%)`;
              }
            }
          }
        }
      }
    });
    
    const filter = document.getElementById('typeFilter');
    filter.innerHTML = '<option value="">–í—Å–µ —Ç–∏–ø—ã —Ä–∞–±–æ—Ç</option>';
    Object.keys(counts).forEach(type => {
      const opt = document.createElement('option');
      opt.value = type;
      opt.textContent = `${type} (${counts[type]})`;
      filter.appendChild(opt);
    });
  }
  
  function renderTopOrdersChart() {
    const top = [...allOrders]
      .sort((a,b) => b.amount - a.amount)
      .slice(0, 5);
    
    const ctx = document.getElementById('topOrdersChart').getContext('2d');
    if (Chart.getChart(ctx)) Chart.getChart(ctx).destroy();
    
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: top.map(o => o.description.length > 25 ? o.description.slice(0,25)+'‚Ä¶' : o.description),
        datasets: [{
          label: '–°—É–º–º–∞',
          data: top.map(o => o.amount),
          backgroundColor: top.map((_, i) => 
            `hsla(${210 - i*25}, 80%, 60%, 0.8)`
          ),
          borderRadius: 8,
          borderSkipped: false
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              title: items => top[items[0].dataIndex].description,
              label: ctx => `üí∞ ${formatCurrency(ctx.parsed.x)}`
            }
          }
        },
        scales: {
          x: {
            ticks: { callback: v => formatCurrency(v) }
          }
        }
      }
    });
  }
  
  // === Progress Bars ===
  function renderProgressBars() {
    const container = document.getElementById('progressBars');
    container.innerHTML = '';
    
    const revenue = allOrders.reduce((s,o) => s + o.amount, 0);
    const count = allOrders.length;
    const targetRev = 5000 * allFilesData.length;
    const targetOrd = 20 * allFilesData.length;
    
    createProgress(container, '–í—ã—Ä—É—á–∫–∞', revenue, targetRev, '‚ÇΩ', '#6366f1');
    createProgress(container, '–ó–∞–∫–∞–∑—ã', count, targetOrd, '', '#10b981');
    
    const types = {};
    allOrders.forEach(o => types[o.type] = (types[o.type]||0)+1);
    const topType = Object.entries(types).sort((a,b) => b[1]-a[1])[0];
    if (topType) {
      createProgress(container, `–¢–∏–ø "${topType[0]}"`, topType[1], Math.max(topType[1]*1.5, 10), '', '#06b6d4');
    }
  }
  
  function createProgress(container, title, current, target, unit, color) {
    const pct = Math.min((current/target)*100, 100);
    const el = document.createElement('div');
    el.className = 'progress-group';
    el.innerHTML = `
      <div class="progress-header">
        <span class="progress-title">${title}</span>
        <span class="progress-value">${formatNumber(current)}${unit} / ${formatNumber(target)}${unit}</span>
      </div>
      <div class="progress">
        <div class="progress-fill" style="width: ${pct}%; background: ${color}"></div>
      </div>
    `;
    container.appendChild(el);
  }
  
  // === Table ===
  function renderDataTable() {
    const tbody = document.getElementById('tableBody');
    tbody.innerHTML = '';
    
    allOrders.forEach(order => {
      const orderId = generateOrderId(order);
      const comments = orderComments[orderId] || [];
      const hasComments = comments.length > 0;
      
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${order.number}</td>
        <td><strong>${order.code}</strong></td>
        <td title="${order.description}">${order.description.slice(0,35)}${order.description.length>35?'‚Ä¶':''}</td>
        <td><span style="background:var(--bg-tertiary);padding:4px 10px;border-radius:20px;font-size:0.85rem">${order.type}</span></td>
        <td>${order.date}</td>
        <td title="${order.sourceFile}">${order.sourceFile.slice(0,20)}${order.sourceFile.length>20?'‚Ä¶':''}</td>
        <td class="amount-cell">${formatCurrency(order.amount)}</td>
        <td>${order.parameters['–ö–≤.–º']?.toFixed(2) || '-'}</td>
        <td>${order.parameters['–ü–æ–≥.–º']?.toFixed(2) || '-'}</td>
        <td class="comment-cell">
          <button class="comment-btn ${hasComments ? 'has-comment' : ''}" 
                  data-order-id="${orderId}"
                  title="${hasComments ? `${comments.length} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π(–µ–≤)` : '–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π'}"
                  onclick="openCommentsModal(${JSON.stringify(order).replace(/"/g, '&quot;')})">
            <i class="fas fa-comment"></i>
            ${hasComments ? `<span class="comment-count">${comments.length}</span>` : ''}
          </button>
        </td>
      `;
      tbody.appendChild(tr);
    });
    
    const dates = [...new Set(allOrders.map(o => o.date))].sort();
    const dateFilter = document.getElementById('dateFilter');
    dateFilter.innerHTML = '<option value="">–í—Å–µ –¥–∞—Ç—ã</option>';
    dates.forEach(d => {
      const opt = document.createElement('option');
      opt.value = d;
      opt.textContent = d;
      dateFilter.appendChild(opt);
    });
  }
  
  function filterTable() {
    const search = document.getElementById('searchInput').value.toLowerCase();
    const type = document.getElementById('typeFilter').value;
    const date = document.getElementById('dateFilter').value;
    
    document.querySelectorAll('#tableBody tr').forEach(row => {
      const cells = row.cells;
      const match = 
        (!search || cells[2].textContent.toLowerCase().includes(search) || cells[1].textContent.toLowerCase().includes(search)) &&
        (!type || cells[3].textContent === type) &&
        (!date || cells[4].textContent === date);
      row.style.display = match ? '' : 'none';
    });
  }
  
  // === History ===
  function updateHistoryList() {
    const list = document.getElementById('historyList');
    list.innerHTML = '';
    
    [...allFilesData].reverse().forEach(file => {
      const item = document.createElement('div');
      item.className = 'history-item';
      item.innerHTML = `
        <div class="history-item-icon"><i class="fas fa-file-lines"></i></div>
        <div class="history-item-details">
          <h4>${file.fileName}</h4>
          <p><i class="far fa-clock"></i> ${file.exportDateTime} ‚Ä¢ <i class="fas fa-coins"></i> ${formatCurrency(file.total)}</p>
        </div>
        <div class="history-item-actions">
          <button class="btn-remove" data-file="${file.fileName}" title="–£–¥–∞–ª–∏—Ç—å">
            <i class="fas fa-xmark"></i>
          </button>
        </div>
      `;
      list.appendChild(item);
    });
    
    document.querySelectorAll('.btn-remove').forEach(btn => {
      btn.onclick = () => {
        const name = btn.dataset.file;
        allFilesData = allFilesData.filter(f => f.fileName !== name);
        allOrders = allFilesData.flatMap(f => f.orders);
        
        // –£–¥–∞–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
        Object.keys(orderComments).forEach(orderId => {
          if (orderId.includes(name)) {
            delete orderComments[orderId];
          }
        });
        saveComments();
        
        updateUI();
        saveDataToLocalStorage();
      };
    });
  }
  
  // === Helpers ===
  function formatCurrency(n) {
    return new Intl.NumberFormat('ru-RU', { 
      style: 'currency', 
      currency: 'RUB',
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    }).format(n).replace('RUB', '‚ÇΩ');
  }
  
  function formatNumber(n) {
    return new Intl.NumberFormat('ru-RU').format(Math.round(n));
  }
  
  function showError(msg) {
    errorList.innerHTML = `<li>${msg}</li>`;
    errorMessage.classList.add('show');
    setTimeout(() => errorMessage.classList.remove('show'), 6000);
  }
  
  function hideError() {
    errorMessage.classList.remove('show');
  }
  
  function resetUI() {
    chartsContainer.style.display = 'none';
    summaryCards.style.display = 'none';
    historySection.style.display = 'none';
    dataTable.style.display = 'none';
    document.getElementById('tableBody').innerHTML = '';
    document.getElementById('historyList').innerHTML = '';
  }

  // === === === COMMENTS MODAL LOGIC === === ===
  
  function openCommentsModal(order) {
    const modal = document.createElement('div');
    modal.className = 'modal-overlay';
    modal.innerHTML = `
      <div class="modal">
        <div class="modal-header">
          <h3><i class="fas fa-comments"></i> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
          <button class="modal-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-order-info">
          <strong>–ó–∞–∫–∞–∑ ‚Ññ${order.number}</strong> ‚Ä¢ ${order.code}<br>
          ${order.description} ‚Ä¢ ${formatCurrency(order.amount)}
        </div>
        <div class="modal-body">
          <div class="comments-list" id="commentsList"></div>
          <div class="comment-form">
            <textarea id="commentInput" placeholder="–î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
            <div class="comment-form-controls">
              <div class="comment-priority-select">
                <button class="priority-btn normal active" data-priority="normal">
                  <i class="fas fa-circle"></i> –û–±—ã—á–Ω—ã–π
                </button>
                <button class="priority-btn important" data-priority="important">
                  <i class="fas fa-exclamation"></i> –í–∞–∂–Ω–æ
                </button>
                <button class="priority-btn urgent" data-priority="urgent">
                  <i class="fas fa-bolt"></i> –°—Ä–æ—á–Ω–æ
                </button>
              </div>
              <button class="comment-submit" id="commentSubmit">
                <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å
              </button>
            </div>
          </div>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    const commentsList = modal.querySelector('#commentsList');
    const commentInput = modal.querySelector('#commentInput');
    const commentSubmit = modal.querySelector('#commentSubmit');
    const priorityBtns = modal.querySelectorAll('.priority-btn');
    const modalClose = modal.querySelector('.modal-close');
    
    let selectedPriority = 'normal';
    
    priorityBtns.forEach(btn => {
      btn.onclick = () => {
        priorityBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedPriority = btn.dataset.priority;
      };
    });
    
    function renderComments() {
      const comments = getOrderComments(order);
      
      if (comments.length === 0) {
        commentsList.innerHTML = `
          <div class="empty-comments">
            <i class="fas fa-comment-slash"></i>
            <p>–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</p>
            <small>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç –∑–∞–º–µ—Ç–∫—É</small>
          </div>
        `;
        return;
      }
      
      commentsList.innerHTML = comments
        .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
        .map(comment => `
          <div class="comment-item ${comment.priority}" data-id="${comment.id}">
            <div class="comment-header">
              <div class="comment-author">
                <i class="fas fa-user-circle"></i>
                ${comment.author}
                ${comment.priority !== 'normal' ? 
                  `<span class="comment-priority ${comment.priority}">
                    <i class="fas fa-${comment.priority === 'important' ? 'exclamation' : 'bolt'}"></i>
                    ${comment.priority === 'important' ? '–í–∞–∂–Ω–æ' : '–°—Ä–æ—á–Ω–æ'}
                  </span>` : ''}
              </div>
              <span class="comment-time" title="${new Date(comment.timestamp).toLocaleString('ru-RU')}">
                ${formatCommentTime(comment.timestamp)}
              </span>
            </div>
            <div class="comment-text">${escapeHtml(comment.text)}</div>
            <div class="comment-actions">
              <button class="comment-action-btn copy" data-text="${escapeHtml(comment.text)}">
                <i class="fas fa-copy"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
              </button>
              <button class="comment-action-btn delete">
                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
              </button>
            </div>
          </div>
        `).join('');
      
      commentsList.querySelectorAll('.delete').forEach(btn => {
        btn.onclick = (e) => {
          const commentItem = e.target.closest('.comment-item');
          const commentId = commentItem.dataset.id;
          if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?')) {
            deleteComment(order, commentId);
            renderComments();
            updateCommentButton(order);
            showToast('–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É–¥–∞–ª—ë–Ω', 'success');
          }
        };
      });
      
      commentsList.querySelectorAll('.copy').forEach(btn => {
        btn.onclick = (e) => {
          const text = e.currentTarget.dataset.text;
          navigator.clipboard.writeText(text);
          showToast('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä', 'success');
        };
      });
    }
    
    commentSubmit.onclick = () => {
      const text = commentInput.value.trim();
      if (!text) {
        commentInput.focus();
        return;
      }
      
      addComment(order, text, selectedPriority);
      commentInput.value = '';
      priorityBtns.forEach(b => b.classList.remove('active'));
      priorityBtns[0].classList.add('active');
      selectedPriority = 'normal';
      
      renderComments();
      updateCommentButton(order);
      showToast('–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω', 'success');
      commentInput.focus();
    };
    
    commentInput.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'Enter') {
        e.preventDefault();
        commentSubmit.click();
      }
    });
    
    modalClose.onclick = closeModal;
    modal.onclick = (e) => {
      if (e.target === modal) closeModal();
    };
    
    function closeModal() {
      modal.classList.remove('active');
      setTimeout(() => modal.remove(), 300);
    }
    
    setTimeout(() => modal.classList.add('active'), 10);
    renderComments();
    commentInput.focus();
  }

  function updateCommentButton(order) {
    const orderId = generateOrderId(order);
    const btn = document.querySelector(`[data-order-id="${orderId}"]`);
    if (btn) {
      const comments = orderComments[orderId] || [];
      if (comments.length > 0) {
        btn.classList.add('has-comment');
        btn.innerHTML = `<i class="fas fa-comment"></i><span class="comment-count">${comments.length}</span>`;
      } else {
        btn.classList.remove('has-comment');
        btn.innerHTML = `<i class="fas fa-comment"></i>`;
        btn.querySelector('.comment-count')?.remove();
      }
    }
  }

  // === Init ===
  loadComments();
  window.openCommentsModal = openCommentsModal;
  
  if (!loadDataFromLocalStorage()) {
    dropZone.style.animation = 'fadeInUp 0.6s ease-out';
  }
});
</script>
</body>
</html>
